<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Miscellaneous</title>
<meta name="generator" content="Org Mode" />
<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/assets/styles/style.css"><link rel="stylesheet" href="/assets/styles/toc-sidebar.css"><script src="/assets/scripts/toc-sidebar.js" defer></script>
</head>
<body>
<main id="content" class="content">
<h1 class="title">Miscellaneous</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge07ef91">1. Introduction</a></li>
<li><a href="#org6d46475">2. Email Configuration</a>
<ul>
<li><a href="#org89d46ae">2.1. Notmuch</a></li>
<li><a href="#org5ff9977">2.2. Email Sending</a></li>
</ul>
</li>
<li><a href="#orgcdca463">3. GPTel - AI Chat Integration</a>
<ul>
<li><a href="#orgb8a9c90">3.1. Core Configuration</a></li>
<li><a href="#org3913333">3.2. Backend Configuration</a></li>
<li><a href="#orgc24a8ea">3.3. Easy Model Switching</a></li>
<li><a href="#org6c4dd39">3.4. Automatic Chat History Saving</a></li>
<li><a href="#org92ecda9">3.5. Enhanced Chat Interface</a></li>
<li><a href="#org01d1a71">3.6. Usage Guide</a></li>
</ul>
</li>
<li><a href="#orga9c38ab">4. PDF Tools</a>
<ul>
<li><a href="#orgb28d2e0">4.1. Core Features</a></li>
<li><a href="#org0cc0544">4.2. Basic Setup</a></li>
<li><a href="#org3295235">4.3. Display and Visual Settings</a></li>
<li><a href="#org423d4d3">4.4. Search and Navigation</a></li>
<li><a href="#org187dca9">4.5. Annotations and Markup</a></li>
<li><a href="#org16808c0">4.6. Bookmarks and Links</a></li>
<li><a href="#orgbc7de15">4.7. Keybindings</a></li>
<li><a href="#org56c4d19">4.8. Helper Functions</a></li>
<li><a href="#org0c7c622">4.9. PDF Keybinding Reference</a></li>
</ul>
</li>
<li><a href="#orgdf859d0">5. Utility Functions</a>
<ul>
<li><a href="#org1872d6c">5.1. Open in External Application</a></li>
<li><a href="#orgc9d762c">5.2. Copy File Path</a></li>
<li><a href="#org5aed1f5">5.3. Reload Configuration</a></li>
<li><a href="#org3ed24a4">5.4. Kill Other Buffers</a></li>
</ul>
</li>
<li><a href="#org81ed633">6. Database Configuration (Disabled)</a></li>
<li><a href="#orgd38c2a0">7. Scratch Buffers</a></li>
<li><a href="#orgd071ef6">8. End of File</a></li>
</ul>
</div>
</div>

<div id="outline-container-orge07ef91" class="outline-2">
<h2 id="orge07ef91"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Miscellaneous utilities and configurations including email, AI chat integration, PDF tools, and helper functions.
</p>
</div>
</div>

<div id="outline-container-org6d46475" class="outline-2">
<h2 id="org6d46475"><span class="section-number-2">2.</span> Email Configuration</h2>
<div class="outline-text-2" id="text-2">
<p>
Configuration for reading and sending email using notmuch and msmtp.
</p>
</div>

<div id="outline-container-org89d46ae" class="outline-3">
<h3 id="org89d46ae"><span class="section-number-3">2.1.</span> Notmuch</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Fast email indexing and searching with notmuch.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">misc-conf.el --- Miscellaneous Configuration  -*- lexical-binding: t; -*-
</span><span class="org-comment-delimiter">;;; </span><span class="org-comment">Commentary:
</span><span class="org-comment-delimiter">;;; </span><span class="org-comment">Miscellaneous utilities including email, AI chat, PDF tools, and helpers.
</span><span class="org-comment-delimiter">;;; </span><span class="org-comment">Code:
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Email - Notmuch
</span>(<span class="org-keyword">use-package</span> notmuch
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:defer</span> t
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> mail-user-agent 'notmuch-user-agent))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5ff9977" class="outline-3">
<h3 id="org5ff9977"><span class="section-number-3">2.2.</span> Email Sending</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Configure email sending with msmtp and authentication.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Email - Sending Configuration
</span>(<span class="org-keyword">setq</span> user-full-name (<span class="org-keyword">or</span> (getenv <span class="org-string">"USER_FULL_NAME"</span>) user-full-name)
      user-mail-address (<span class="org-keyword">or</span> (getenv <span class="org-string">"USER_EMAIL"</span>) user-mail-address)
      auth-sources '(<span class="org-string">"~/.authinfo.gpg"</span> <span class="org-string">"~/.authinfo"</span>))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Use msmtp for sending mail
</span>(<span class="org-keyword">setq</span> send-mail-function 'sendmail-send-it
      message-send-mail-function 'message-send-mail-with-sendmail
      sendmail-program (<span class="org-keyword">or</span> (executable-find <span class="org-string">"msmtp"</span>) <span class="org-string">"/usr/bin/msmtp"</span>)
      message-sendmail-envelope-from 'header)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcdca463" class="outline-2">
<h2 id="orgcdca463"><span class="section-number-2">3.</span> GPTel - AI Chat Integration</h2>
<div class="outline-text-2" id="text-3">
<p>
Comprehensive AI chat integration with support for multiple providers (OpenAI, Claude, Gemini, etc.) with easy model switching and automatic chat history saving.
</p>
</div>

<div id="outline-container-orgb8a9c90" class="outline-3">
<h3 id="orgb8a9c90"><span class="section-number-3">3.1.</span> Core Configuration</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">GPTel - AI Chat Integration
</span>(<span class="org-keyword">use-package</span> gptel
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:custom</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default mode for chat buffers
</span>  (gptel-default-mode 'org-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory for saving chat history
</span>  (gptel-chat-history-directory
   (expand-file-name <span class="org-string">"gptel-history"</span> user-emacs-directory))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Model settings
</span>  (gptel-model <span class="org-string">"claude-opus-4-5-20251101"</span>)
  (gptel-backend nil)  <span class="org-comment-delimiter">; </span><span class="org-comment">Will be set by backend setup
</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Streaming responses
</span>  (gptel-stream t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display settings
</span>  (gptel-use-curl t)
  (gptel-crowdsource-default-mode 'org-mode)

  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure chat history directory exists
</span>  (<span class="org-keyword">let</span> ((history-dir (expand-file-name <span class="org-string">"gptel-history"</span> user-emacs-directory)))
    (<span class="org-keyword">unless</span> (file-directory-p history-dir)
      (make-directory history-dir t))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3913333" class="outline-3">
<h3 id="org3913333"><span class="section-number-3">3.2.</span> Backend Configuration</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Set up multiple AI backends with API keys from environment variables or auth-sources.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">GPTel Backend Configuration
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Helper function to get API key
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-get-api-key</span> (service)
  <span class="org-doc">"Get API key for SERVICE from environment or auth-sources.
SERVICE should be something like '</span><span class="org-doc"><span class="org-constant">OPENAI_API_KEY</span></span><span class="org-doc">' or '</span><span class="org-doc"><span class="org-constant">ANTHROPIC_API_KEY</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">or</span> (getenv service)
      (plist-get (car (auth-source-search <span class="org-builtin">:host</span> service)) <span class="org-builtin">:secret</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Configure backends
</span>(<span class="org-keyword">with-eval-after-load</span> 'gptel
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Anthropic (Claude)
</span>  (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"CLAUDE_API_KEY"</span>)))
    (<span class="org-keyword">setq</span> gptel-anthropic-key key)
    (<span class="org-keyword">unless</span> gptel-backend
      (<span class="org-keyword">setq</span> gptel-backend
            (gptel-make-anthropic <span class="org-string">"Claude"</span>
              <span class="org-builtin">:stream</span> t
              <span class="org-builtin">:key</span> key))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">OpenAI (GPT)
</span>  (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"OPENAI_API_KEY"</span>)))
    (<span class="org-keyword">setq</span> gptel-openai-key key)
    (gptel-make-openai <span class="org-string">"ChatGPT"</span>
      <span class="org-builtin">:stream</span> t
      <span class="org-builtin">:key</span> key
      <span class="org-builtin">:models</span> '(<span class="org-string">"gpt-5.1-2025-11-13"</span>
                <span class="org-string">"gpt-5.1-codex"</span>
                <span class="org-string">"gpt-4.1"</span>
                <span class="org-string">"gpt-4.1-mini"</span>
                <span class="org-string">"gpt-4.1-nano"</span>
                <span class="org-string">"gpt-4o"</span>
                <span class="org-string">"gpt-4o-mini"</span>
                <span class="org-string">"gpt-4-turbo"</span>
                <span class="org-string">"gpt-3.5-turbo"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Google (Gemini)
</span>  (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"GEMINI_API_KEY"</span>)))
    (gptel-make-gemini <span class="org-string">"Gemini"</span>
      <span class="org-builtin">:stream</span> t
      <span class="org-builtin">:key</span> key
      <span class="org-builtin">:models</span> '(<span class="org-string">"gemini-3-pro-preview"</span>
                <span class="org-string">"gemini-2.5-pro"</span>
                <span class="org-string">"gemini-2.5-flash"</span>
                <span class="org-string">"gemini-2.5-flash-lite-preview"</span>
                <span class="org-string">"gemini-2.0-flash-exp"</span>
                <span class="org-string">"gemini-1.5-pro"</span>
                <span class="org-string">"gemini-1.5-flash"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc24a8ea" class="outline-3">
<h3 id="orgc24a8ea"><span class="section-number-3">3.3.</span> Easy Model Switching</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Convenient functions to switch between different AI models quickly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">GPTel Model Switching Functions
</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">fu/gptel-models</span>
  '(<span class="org-comment-delimiter">;; </span><span class="org-comment">Claude models (newest first)
</span>    (<span class="org-string">"Claude Opus 4.5"</span> . (anthropic <span class="org-string">"claude-opus-4-5-20251101"</span>))
    (<span class="org-string">"Claude Sonnet 4.5"</span> . (anthropic <span class="org-string">"claude-sonnet-4-5-20250929"</span>))
    (<span class="org-string">"Claude Opus 4.1"</span> . (anthropic <span class="org-string">"claude-opus-4-1-20250805"</span>))
    (<span class="org-string">"Claude Opus 4"</span> . (anthropic <span class="org-string">"claude-opus-4-20250514"</span>))
    (<span class="org-string">"Claude Sonnet 4"</span> . (anthropic <span class="org-string">"claude-sonnet-4-20250514"</span>))
    (<span class="org-string">"Claude 3.5 Sonnet"</span> . (anthropic <span class="org-string">"claude-3-5-sonnet-20241022"</span>))
    (<span class="org-string">"Claude 3 Opus"</span> . (anthropic <span class="org-string">"claude-3-opus-20240229"</span>))
    (<span class="org-string">"Claude 3 Haiku"</span> . (anthropic <span class="org-string">"claude-3-haiku-20240307"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">OpenAI models (newest first)
</span>    (<span class="org-string">"GPT-5.1"</span> . (openai <span class="org-string">"gpt-5.1-2025-11-13"</span>))
    (<span class="org-string">"GPT-5.1 Codex"</span> . (openai <span class="org-string">"gpt-5.1-codex"</span>))
    (<span class="org-string">"GPT-4.1"</span> . (openai <span class="org-string">"gpt-4.1"</span>))
    (<span class="org-string">"GPT-4.1 Mini"</span> . (openai <span class="org-string">"gpt-4.1-mini"</span>))
    (<span class="org-string">"GPT-4.1 Nano"</span> . (openai <span class="org-string">"gpt-4.1-nano"</span>))
    (<span class="org-string">"GPT-4o"</span> . (openai <span class="org-string">"gpt-4o"</span>))
    (<span class="org-string">"GPT-4o Mini"</span> . (openai <span class="org-string">"gpt-4o-mini"</span>))
    (<span class="org-string">"GPT-4 Turbo"</span> . (openai <span class="org-string">"gpt-4-turbo"</span>))
    (<span class="org-string">"GPT-3.5 Turbo"</span> . (openai <span class="org-string">"gpt-3.5-turbo"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Gemini models (newest first)
</span>    (<span class="org-string">"Gemini 3 Pro"</span> . (gemini <span class="org-string">"gemini-3-pro-preview"</span>))
    (<span class="org-string">"Gemini 2.5 Pro"</span> . (gemini <span class="org-string">"gemini-2.5-pro"</span>))
    (<span class="org-string">"Gemini 2.5 Flash"</span> . (gemini <span class="org-string">"gemini-2.5-flash"</span>))
    (<span class="org-string">"Gemini 2.5 Flash Lite"</span> . (gemini <span class="org-string">"gemini-2.5-flash-lite-preview"</span>))
    (<span class="org-string">"Gemini 2.0 Flash"</span> . (gemini <span class="org-string">"gemini-2.0-flash-exp"</span>))
    (<span class="org-string">"Gemini 1.5 Pro"</span> . (gemini <span class="org-string">"gemini-1.5-pro"</span>))
    (<span class="org-string">"Gemini 1.5 Flash"</span> . (gemini <span class="org-string">"gemini-1.5-flash"</span>)))
  <span class="org-doc">"Alist of model display names to (provider model-id) pairs."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-set-model</span> (model-name)
  <span class="org-doc">"Switch GPTel to MODEL-NAME from predefined list."</span>
  (<span class="org-keyword">interactive</span>
   (list (completing-read <span class="org-string">"Select AI model: "</span>
                         (mapcar #'car fu/gptel-models)
                         nil t)))
  (<span class="org-keyword">when-let*</span> ((model-info (alist-get model-name fu/gptel-models nil nil #'string=))
              (provider (car model-info))
              (model-id (cadr model-info)))
    (<span class="org-keyword">pcase</span> provider
      ('anthropic
       (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"CLAUDE_API_KEY"</span>)))
         (<span class="org-keyword">setq</span> gptel-backend (gptel-make-anthropic <span class="org-string">"Claude"</span> <span class="org-builtin">:stream</span> t <span class="org-builtin">:key</span> key)
               gptel-model model-id)
         (message <span class="org-string">"Switched to %s (%s)"</span> model-name model-id)))
      ('openai
       (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"OPENAI_API_KEY"</span>)))
         (<span class="org-keyword">setq</span> gptel-backend (gptel-make-openai <span class="org-string">"ChatGPT"</span> <span class="org-builtin">:stream</span> t <span class="org-builtin">:key</span> key)
               gptel-model model-id)
         (message <span class="org-string">"Switched to %s (%s)"</span> model-name model-id)))
      ('gemini
       (<span class="org-keyword">when-let</span> ((key (fu/gptel-get-api-key <span class="org-string">"GEMINI_API_KEY"</span>)))
         (<span class="org-keyword">setq</span> gptel-backend (gptel-make-gemini <span class="org-string">"Gemini"</span> <span class="org-builtin">:stream</span> t <span class="org-builtin">:key</span> key)
               gptel-model model-id)
         (message <span class="org-string">"Switched to %s (%s)"</span> model-name model-id))))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Quick switch functions
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-use-claude</span> ()
  <span class="org-doc">"Switch to Claude Opus 4.5 (latest)."</span>
  (<span class="org-keyword">interactive</span>)
  (fu/gptel-set-model <span class="org-string">"Claude Opus 4.5"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-use-gpt4</span> ()
  <span class="org-doc">"Switch to GPT-5.1 (latest)."</span>
  (<span class="org-keyword">interactive</span>)
  (fu/gptel-set-model <span class="org-string">"GPT-5.1"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-use-gemini</span> ()
  <span class="org-doc">"Switch to Gemini 3 Pro (latest)."</span>
  (<span class="org-keyword">interactive</span>)
  (fu/gptel-set-model <span class="org-string">"Gemini 3 Pro"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6c4dd39" class="outline-3">
<h3 id="org6c4dd39"><span class="section-number-3">3.4.</span> Automatic Chat History Saving</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Automatically save chat conversations to disk with timestamps and model information.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">GPTel Chat History Management
</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-save-chat</span> ()
  <span class="org-doc">"Save current gptel chat buffer to history directory."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (derived-mode-p 'org-mode)
             (<span class="org-keyword">bound-and-true-p</span> gptel-mode))
    (<span class="org-keyword">let*</span> ((timestamp (format-time-string <span class="org-string">"%Y%m%d-%H%M%S"</span>))
           (model-name (replace-regexp-in-string <span class="org-string">"[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">a-zA-Z0-9-]"</span> <span class="org-string">"-"</span> gptel-model))
           (filename (format <span class="org-string">"%s-%s.org"</span> timestamp model-name))
           (filepath (expand-file-name filename gptel-chat-history-directory)))
      (write-region (point-min) (point-max) filepath)
      (message <span class="org-string">"Chat saved to: %s"</span> filepath)
      filepath)))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-auto-save-chat</span> ()
  <span class="org-doc">"Automatically save chat if it has content."</span>
  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (derived-mode-p 'org-mode)
             (<span class="org-keyword">bound-and-true-p</span> gptel-mode)
             (&gt; (buffer-size) 100))  <span class="org-comment-delimiter">; </span><span class="org-comment">Only save if buffer has content
</span>    (fu/gptel-save-chat)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-save chat on buffer kill
</span>(add-hook 'kill-buffer-hook #'fu/gptel-auto-save-chat)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Periodic auto-save (every 5 minutes)
</span>(<span class="org-keyword">defvar</span> <span class="org-variable-name">fu/gptel-auto-save-timer</span> nil
  <span class="org-doc">"Timer for auto-saving gptel chats."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-enable-auto-save</span> ()
  <span class="org-doc">"Enable periodic auto-saving of gptel chats."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when</span> fu/gptel-auto-save-timer
    (cancel-timer fu/gptel-auto-save-timer))
  (<span class="org-keyword">setq</span> fu/gptel-auto-save-timer
        (run-with-idle-timer 300 t
                            (<span class="org-keyword">lambda</span> ()
                              (<span class="org-keyword">dolist</span> (buf (buffer-list))
                                (<span class="org-keyword">with-current-buffer</span> buf
                                  (fu/gptel-auto-save-chat))))))
  (message <span class="org-string">"GPTel auto-save enabled (every 5 minutes when idle)"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-disable-auto-save</span> ()
  <span class="org-doc">"Disable periodic auto-saving of gptel chats."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when</span> fu/gptel-auto-save-timer
    (cancel-timer fu/gptel-auto-save-timer)
    (<span class="org-keyword">setq</span> fu/gptel-auto-save-timer nil)
    (message <span class="org-string">"GPTel auto-save disabled"</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Load a saved chat
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-load-chat</span> ()
  <span class="org-doc">"Load a previously saved chat from history."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> ((files (directory-files gptel-chat-history-directory nil <span class="org-string">"\\.org$"</span>))
         (file (completing-read <span class="org-string">"Load chat: "</span> (nreverse files) nil t)))
    (<span class="org-keyword">when</span> file
      (find-file (expand-file-name file gptel-chat-history-directory))
      (gptel-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org92ecda9" class="outline-3">
<h3 id="org92ecda9"><span class="section-number-3">3.5.</span> Enhanced Chat Interface</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Improved chat interface with better defaults and keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">GPTel Enhanced Interface
</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">fu/gptel-new-chat</span> ()
  <span class="org-doc">"Start a new gptel chat with current model information in header."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> ((model-info (format <span class="org-string">"Model: %s"</span> gptel-model))
         (timestamp (format-time-string <span class="org-string">"%Y-%m-%d %H:%M"</span>))
         (buf-name (format <span class="org-string">"*gptel-%s*"</span> timestamp)))
    (<span class="org-keyword">with-current-buffer</span> (get-buffer-create buf-name)
      (org-mode)
      (gptel-mode 1)
      (insert (format <span class="org-string">"#+TITLE: AI Chat - %s\n"</span> timestamp))
      (insert (format <span class="org-string">"#+DATE: %s\n"</span> timestamp))
      (insert (format <span class="org-string">"#+MODEL: %s\n"</span> gptel-model))
      (insert (format <span class="org-string">"#+BACKEND: %s\n\n"</span> (gptel-backend-name gptel-backend)))
      (insert <span class="org-string">"* Chat\n\n"</span>)
      (goto-char (point-max)))
    (switch-to-buffer buf-name)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keybindings for gptel
</span>(<span class="org-keyword">with-eval-after-load</span> 'gptel
  (define-key gptel-mode-map (kbd <span class="org-string">"C-c g s"</span>) #'fu/gptel-save-chat)
  (define-key gptel-mode-map (kbd <span class="org-string">"C-c g m"</span>) #'fu/gptel-set-model)
  (define-key gptel-mode-map (kbd <span class="org-string">"C-c g n"</span>) #'fu/gptel-new-chat)
  (define-key gptel-mode-map (kbd <span class="org-string">"C-c g l"</span>) #'fu/gptel-load-chat))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Global keybindings
</span>(global-set-key (kbd <span class="org-string">"C-c a n"</span>) #'fu/gptel-new-chat)
(global-set-key (kbd <span class="org-string">"C-c a m"</span>) #'fu/gptel-set-model)
(global-set-key (kbd <span class="org-string">"C-c a l"</span>) #'fu/gptel-load-chat)
(global-set-key (kbd <span class="org-string">"C-c a c"</span>) #'fu/gptel-use-claude)
(global-set-key (kbd <span class="org-string">"C-c a g"</span>) #'fu/gptel-use-gpt4)
(global-set-key (kbd <span class="org-string">"C-c a G"</span>) #'fu/gptel-use-gemini)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Enable auto-save by default
</span>(<span class="org-keyword">with-eval-after-load</span> 'gptel
  (fu/gptel-enable-auto-save))
</pre>
</div>
</div>
</div>

<div id="outline-container-org01d1a71" class="outline-3">
<h3 id="org01d1a71"><span class="section-number-3">3.6.</span> Usage Guide</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Quick reference for using gptel:
</p>
</div>

<div id="outline-container-org2f121d2" class="outline-4">
<h4 id="org2f121d2"><span class="section-number-4">3.6.1.</span> Starting a Chat</h4>
<div class="outline-text-4" id="text-3-6-1">
<ul class="org-ul">
<li><code>C-c a n</code> : Start new chat with current model</li>
<li><code>M-x gptel</code> : Start chat in current buffer</li>
</ul>
</div>
</div>

<div id="outline-container-org35932d2" class="outline-4">
<h4 id="org35932d2"><span class="section-number-4">3.6.2.</span> Model Switching</h4>
<div class="outline-text-4" id="text-3-6-2">
<ul class="org-ul">
<li><code>C-c a m</code> : Choose from all available models</li>
<li><code>C-c a c</code> : Quick switch to Claude Opus 4.5 (latest)</li>
<li><code>C-c a g</code> : Quick switch to GPT-5.1 (latest)</li>
<li><code>C-c a G</code> : Quick switch to Gemini 3 Pro (latest)</li>
</ul>
</div>
</div>

<div id="outline-container-org99ae8fe" class="outline-4">
<h4 id="org99ae8fe"><span class="section-number-4">3.6.3.</span> Chat Management</h4>
<div class="outline-text-4" id="text-3-6-3">
<ul class="org-ul">
<li><code>C-c g s</code> : Manually save current chat (in gptel buffer)</li>
<li><code>C-c a l</code> : Load a saved chat from history</li>
<li>Auto-save: Chats automatically save every 5 minutes when idle</li>
<li>Auto-save on buffer kill: Chats save when you close the buffer</li>
</ul>
</div>
</div>

<div id="outline-container-org958c655" class="outline-4">
<h4 id="org958c655"><span class="section-number-4">3.6.4.</span> In Chat Buffer</h4>
<div class="outline-text-4" id="text-3-6-4">
<ul class="org-ul">
<li><code>C-c RET</code> : Send message</li>
<li><code>C-c g m</code> : Switch model mid-conversation</li>
<li><code>C-c g n</code> : Start new chat</li>
</ul>
</div>
</div>

<div id="outline-container-orgf559a18" class="outline-4">
<h4 id="orgf559a18"><span class="section-number-4">3.6.5.</span> Configuration</h4>
<div class="outline-text-4" id="text-3-6-5">
<p>
API keys should be set as environment variables:
</p>
<ul class="org-ul">
<li><code>CLAUDE_API_KEY</code> : For Claude models (Anthropic)</li>
<li><code>OPENAI_API_KEY</code> : For GPT models (OpenAI)</li>
<li><code>GEMINI_API_KEY</code> : For Gemini models (Google)</li>
</ul>

<p>
Or stored in <code>~/.authinfo.gpg</code> with host entries matching the key names.
</p>

<p>
Chat history location: <code>~/.emacs.d/gptel-history/</code> (customizable via <code>gptel-chat-history-directory</code>)
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orga9c38ab" class="outline-2">
<h2 id="orga9c38ab"><span class="section-number-2">4.</span> PDF Tools</h2>
<div class="outline-text-2" id="text-4">
<p>
Comprehensive PDF viewing and annotation system with powerful search, annotation, bookmark, and navigation features.
</p>

<p>
Reference: <a href="https://emacselements.com/pdf-tools-settings.html">EmacsElements PDF Tools Settings</a>
</p>
</div>

<div id="outline-container-orgb28d2e0" class="outline-3">
<h3 id="orgb28d2e0"><span class="section-number-3">4.1.</span> Core Features</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>High-quality PDF rendering with native performance</li>
<li>Full-text search with occur mode for document-wide searches</li>
<li>Rich annotation support (highlight, underline, strikethrough, text notes)</li>
<li>Bookmarks and outline/TOC navigation</li>
<li>Region marking and text selection</li>
<li>Image extraction and manipulation</li>
<li>Link following and history navigation</li>
<li>Dark mode support (midnight mode)</li>
<li>Auto-revert for live-updating PDFs</li>
<li>Slice mode for cropping margins</li>
</ul>
</div>
</div>

<div id="outline-container-org0cc0544" class="outline-3">
<h3 id="org0cc0544"><span class="section-number-3">4.2.</span> Basic Setup</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Core Configuration
</span>(<span class="org-keyword">use-package</span> pdf-tools
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:mode</span> (<span class="org-string">"\\.pdf\\'"</span> . pdf-view-mode)
  <span class="org-builtin">:magic</span> (<span class="org-string">"%PDF"</span> . pdf-view-mode)
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Install pdf-tools
</span>  (pdf-tools-install <span class="org-builtin">:no-query</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Custom settings
</span>  (<span class="org-keyword">setq-default</span> pdf-view-display-size 'fit-page)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Performance
</span>  (<span class="org-keyword">setq</span> pdf-view-use-scaling t
        pdf-view-use-imagemagick nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Annotation settings
</span>  (<span class="org-keyword">setq</span> pdf-annot-activate-created-annotations t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-revert PDFs when file changes
</span>  (add-hook 'pdf-view-mode-hook #'auto-revert-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">More frequent auto-revert for PDFs
</span>  (<span class="org-keyword">setq</span> auto-revert-interval 0.5))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3295235" class="outline-3">
<h3 id="org3295235"><span class="section-number-3">4.3.</span> Display and Visual Settings</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Display Settings
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-view
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Midnight mode colors (dark mode)
</span>  (<span class="org-keyword">setq</span> pdf-view-midnight-colors '(<span class="org-string">"#ffffff"</span> . <span class="org-string">"#000000"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Resize factor
</span>  (<span class="org-keyword">setq</span> pdf-view-resize-factor 1.1)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Continuous scroll
</span>  (<span class="org-keyword">setq</span> pdf-view-continuous t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display options
</span>  (<span class="org-keyword">setq</span> pdf-view-display-size 'fit-width)
  (<span class="org-keyword">setq</span> pdf-view-use-dedicated-register t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org423d4d3" class="outline-3">
<h3 id="org423d4d3"><span class="section-number-3">4.4.</span> Search and Navigation</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Enhanced Search
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-isearch
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Search settings
</span>  (<span class="org-keyword">setq</span> pdf-isearch-hyphenation-character <span class="org-string">"-\u00ad"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Batch mode for faster search
</span>  (<span class="org-keyword">setq</span> pdf-isearch-batch-mode t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Custom search face
</span>  (set-face-attribute 'pdf-isearch-match nil
                      <span class="org-builtin">:background</span> <span class="org-string">"yellow"</span>
                      <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span>))

<span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Occur - Search across entire document
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-occur
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Occur buffer settings
</span>  (<span class="org-keyword">setq</span> pdf-occur-prefer-string-search t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org187dca9" class="outline-3">
<h3 id="org187dca9"><span class="section-number-3">4.5.</span> Annotations and Markup</h3>
<div class="outline-text-3" id="text-4-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Annotations
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-annot
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Annotation list settings
</span>  (<span class="org-keyword">setq</span> pdf-annot-list-format '((page . 3)
                                (type . 10)
                                (label . 15)
                                (contents . 0)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Annotation highlight colors
</span>  (<span class="org-keyword">setq</span> pdf-annot-default-annotation-properties
        '((t (label . <span class="org-string">"User"</span>))
          (highlight (color . <span class="org-string">"yellow"</span>))
          (underline (color . <span class="org-string">"blue"</span>))
          (squiggly (color . <span class="org-string">"orange"</span>))
          (strike-out (color . <span class="org-string">"red"</span>))
          (text (icon . <span class="org-string">"Note"</span>)
                (color . <span class="org-string">"gold"</span>))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode settings
</span>  (<span class="org-keyword">setq</span> pdf-annot-minor-mode-map-prefix (kbd <span class="org-string">"C-c a"</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Custom annotation functions
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-annot-add-highlight</span> ()
  <span class="org-doc">"Add highlight annotation to selected region."</span>
  (<span class="org-keyword">interactive</span>)
  (pdf-annot-add-highlight-markup-annotation
   (pdf-view-active-region) <span class="org-string">"yellow"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-annot-add-underline</span> ()
  <span class="org-doc">"Add underline annotation to selected region."</span>
  (<span class="org-keyword">interactive</span>)
  (pdf-annot-add-underline-markup-annotation
   (pdf-view-active-region) <span class="org-string">"blue"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-annot-add-strikeout</span> ()
  <span class="org-doc">"Add strikeout annotation to selected region."</span>
  (<span class="org-keyword">interactive</span>)
  (pdf-annot-add-strikeout-markup-annotation
   (pdf-view-active-region) <span class="org-string">"red"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-annot-add-text-note</span> ()
  <span class="org-doc">"Add text note annotation at point."</span>
  (<span class="org-keyword">interactive</span>)
  (pdf-annot-add-text-annotation
   (pdf-view-active-region)
   (read-string <span class="org-string">"Note: "</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org16808c0" class="outline-3">
<h3 id="org16808c0"><span class="section-number-3">4.6.</span> Bookmarks and Links</h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Bookmarks
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-view
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable bookmark support
</span>  (<span class="org-keyword">setq</span> pdf-view-use-dedicated-register t))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Save place in PDF files
</span>(<span class="org-keyword">use-package</span> saveplace-pdf-view
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:after</span> pdf-tools
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remember last position in PDFs
</span>  (save-place-mode 1))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Custom bookmark functions
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-bookmark-set</span> ()
  <span class="org-doc">"Set a bookmark in the current PDF."</span>
  (<span class="org-keyword">interactive</span>)
  (bookmark-set (format <span class="org-string">"PDF: %s - p%d"</span>
                       (file-name-nondirectory (buffer-file-name))
                       (pdf-view-current-page))))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-bookmark-jump</span> ()
  <span class="org-doc">"Jump to a PDF bookmark."</span>
  (<span class="org-keyword">interactive</span>)
  (bookmark-jump
   (completing-read <span class="org-string">"PDF Bookmark: "</span>
                   (cl-remove-if-not
                    (<span class="org-keyword">lambda</span> (bmk)
                      (string-prefix-p <span class="org-string">"PDF: "</span> (car bmk)))
                    bookmark-alist))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbc7de15" class="outline-3">
<h3 id="orgbc7de15"><span class="section-number-3">4.7.</span> Keybindings</h3>
<div class="outline-text-3" id="text-4-7">
<p>
Comprehensive keybinding setup for all PDF operations.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Keybindings
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-view
  (<span class="org-keyword">let</span> ((map pdf-view-mode-map))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Basic navigation
</span>    (define-key map (kbd <span class="org-string">"j"</span>) 'pdf-view-next-line-or-next-page)
    (define-key map (kbd <span class="org-string">"k"</span>) 'pdf-view-previous-line-or-previous-page)
    (define-key map (kbd <span class="org-string">"h"</span>) 'image-backward-hscroll)
    (define-key map (kbd <span class="org-string">"l"</span>) 'image-forward-hscroll)
    (define-key map (kbd <span class="org-string">"J"</span>) 'pdf-view-next-page)
    (define-key map (kbd <span class="org-string">"K"</span>) 'pdf-view-previous-page)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key map (kbd "g g") 'pdf-view-first-page)
</span>    (define-key map (kbd <span class="org-string">"G"</span>) 'pdf-view-last-page)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key map (kbd "g t") 'pdf-view-goto-page)
</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Search
</span>    (define-key map (kbd <span class="org-string">"C-s"</span>) 'isearch-forward)
    (define-key map (kbd <span class="org-string">"C-r"</span>) 'isearch-backward)
    (define-key map (kbd <span class="org-string">"s s"</span>) 'pdf-occur)
    (define-key map (kbd <span class="org-string">"s r"</span>) 'pdf-isearch-batch-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Zoom and display
</span>    (define-key map (kbd <span class="org-string">"+"</span>) 'pdf-view-enlarge)
    (define-key map (kbd <span class="org-string">"-"</span>) 'pdf-view-shrink)
    (define-key map (kbd <span class="org-string">"0"</span>) 'pdf-view-scale-reset)
    (define-key map (kbd <span class="org-string">"W"</span>) 'pdf-view-fit-width-to-window)
    (define-key map (kbd <span class="org-string">"H"</span>) 'pdf-view-fit-height-to-window)
    (define-key map (kbd <span class="org-string">"P"</span>) 'pdf-view-fit-page-to-window)
    (define-key map (kbd <span class="org-string">"m"</span>) 'pdf-view-midnight-minor-mode)
    (define-key map (kbd <span class="org-string">"s l"</span>) 'pdf-view-set-slice-using-mouse)
    (define-key map (kbd <span class="org-string">"s b"</span>) 'pdf-view-set-slice-from-bounding-box)
    (define-key map (kbd <span class="org-string">"s r"</span>) 'pdf-view-reset-slice)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Annotations
</span>    (define-key map (kbd <span class="org-string">"a h"</span>) 'fu/pdf-annot-add-highlight)
    (define-key map (kbd <span class="org-string">"a u"</span>) 'fu/pdf-annot-add-underline)
    (define-key map (kbd <span class="org-string">"a s"</span>) 'fu/pdf-annot-add-strikeout)
    (define-key map (kbd <span class="org-string">"a t"</span>) 'fu/pdf-annot-add-text-note)
    (define-key map (kbd <span class="org-string">"a d"</span>) 'pdf-annot-delete)
    (define-key map (kbd <span class="org-string">"a l"</span>) 'pdf-annot-list-annotations)
    (define-key map (kbd <span class="org-string">"a n"</span>) 'pdf-annot-next-annotation)
    (define-key map (kbd <span class="org-string">"a p"</span>) 'pdf-annot-previous-annotation)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Outline and links
</span>    (define-key map (kbd <span class="org-string">"o"</span>) 'pdf-outline)
    (define-key map (kbd <span class="org-string">"f"</span>) 'pdf-links-action-perform)
    (define-key map (kbd <span class="org-string">"F"</span>) 'pdf-links-isearch-link)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bookmarks
</span>    (define-key map (kbd <span class="org-string">"b s"</span>) 'fu/pdf-bookmark-set)
    (define-key map (kbd <span class="org-string">"b j"</span>) 'fu/pdf-bookmark-jump)
    (define-key map (kbd <span class="org-string">"b l"</span>) 'bookmark-bmenu-list)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">History
</span>    (define-key map (kbd <span class="org-string">"B"</span>) 'pdf-history-backward)
    (define-key map (kbd <span class="org-string">"N"</span>) 'pdf-history-forward)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Misc
</span>    (define-key map (kbd <span class="org-string">"r"</span>) 'pdf-view-revert-buffer)
    (define-key map (kbd <span class="org-string">"t"</span>) 'pdf-annot-attachment-dired)
    (define-key map (kbd <span class="org-string">"n"</span>) 'pdf-view-next-page-command)
    (define-key map (kbd <span class="org-string">"p"</span>) 'pdf-view-previous-page-command)
    (define-key map (kbd <span class="org-string">"SPC"</span>) 'pdf-view-scroll-up-or-next-page)
    (define-key map (kbd <span class="org-string">"DEL"</span>) 'pdf-view-scroll-down-or-previous-page)
    (define-key map (kbd <span class="org-string">"C-c C-c"</span>) 'pdf-misc-display-metadata)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org56c4d19" class="outline-3">
<h3 id="org56c4d19"><span class="section-number-3">4.8.</span> Helper Functions</h3>
<div class="outline-text-3" id="text-4-8">
<p>
Additional utility functions for enhanced PDF workflow.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">PDF Tools - Helper Functions
</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-print-buffer</span> ()
  <span class="org-doc">"Print current PDF buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (pdf-misc-print-document (buffer-file-name)))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-copy-region-as-text</span> ()
  <span class="org-doc">"Copy selected region as text."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when</span> (pdf-view-active-region-p)
    (<span class="org-keyword">let</span> ((text (pdf-view-active-region-text)))
      (kill-new (mapconcat 'identity text <span class="org-string">"\n"</span>))
      (message <span class="org-string">"Copied PDF text to clipboard"</span>))))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-extract-images</span> ()
  <span class="org-doc">"Extract images from current PDF."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> ((file (buffer-file-name))
         (dir (file-name-sans-extension file)))
    (make-directory dir t)
    (shell-command
     (format <span class="org-string">"pdfimages -all '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' '</span><span class="org-string"><span class="org-constant">%s/image</span></span><span class="org-string">'"</span> file dir))
    (message <span class="org-string">"Extracted images to %s"</span> dir)
    (dired dir)))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-count-pages</span> ()
  <span class="org-doc">"Display the number of pages in current PDF."</span>
  (<span class="org-keyword">interactive</span>)
  (message <span class="org-string">"PDF has %d pages"</span> (pdf-cache-number-of-pages)))

(<span class="org-keyword">defun</span> <span class="org-function-name">fu/pdf-rotate-page</span> (degrees)
  <span class="org-doc">"Rotate current page by DEGREES (90, 180, or 270)."</span>
  (<span class="org-keyword">interactive</span>
   (list (string-to-number
          (completing-read <span class="org-string">"Rotate by degrees: "</span>
                         '(<span class="org-string">"90"</span> <span class="org-string">"180"</span> <span class="org-string">"270"</span>)))))
  (pdf-view-rotate degrees))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Global keybindings for PDF functions
</span>(<span class="org-keyword">with-eval-after-load</span> 'pdf-view
  (define-key pdf-view-mode-map (kbd <span class="org-string">"w"</span>) 'fu/pdf-copy-region-as-text)
  (define-key pdf-view-mode-map (kbd <span class="org-string">"C-c C-p"</span>) 'fu/pdf-print-buffer)
  (define-key pdf-view-mode-map (kbd <span class="org-string">"C-c i"</span>) 'fu/pdf-extract-images)
  (define-key pdf-view-mode-map (kbd <span class="org-string">"C-c n"</span>) 'fu/pdf-count-pages)
  (define-key pdf-view-mode-map (kbd <span class="org-string">"R"</span>) 'fu/pdf-rotate-page))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c7c622" class="outline-3">
<h3 id="org0c7c622"><span class="section-number-3">4.9.</span> PDF Keybinding Reference</h3>
<div class="outline-text-3" id="text-4-9">
<p>
Quick reference for PDF Tools keybindings:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Category</th>
<th scope="col" class="org-left">Key</th>
<th scope="col" class="org-left">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><b>Navigation</b></td>
<td class="org-left">j/k</td>
<td class="org-left">Line up/down</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">J/K</td>
<td class="org-left">Page down/up</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">g g</td>
<td class="org-left">First page</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">Last page</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">g t</td>
<td class="org-left">Go to page</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">SPC/DEL</td>
<td class="org-left">Page down/up</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">h/l</td>
<td class="org-left">Scroll left/right</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">B/N</td>
<td class="org-left">History back/forward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Search</b></td>
<td class="org-left">C-s/C-r</td>
<td class="org-left">Incremental search</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s s</td>
<td class="org-left">Search all (occur)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s r</td>
<td class="org-left">Batch search</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Display</b></td>
<td class="org-left">+/-</td>
<td class="org-left">Zoom in/out</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">0</td>
<td class="org-left">Reset zoom</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">W/H/P</td>
<td class="org-left">Fit width/height/page</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">m</td>
<td class="org-left">Toggle dark mode</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s l</td>
<td class="org-left">Set slice (crop)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s b</td>
<td class="org-left">Slice from bounding box</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s r</td>
<td class="org-left">Reset slice</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">R</td>
<td class="org-left">Rotate page</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Annotate</b></td>
<td class="org-left">a h</td>
<td class="org-left">Add highlight</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a u</td>
<td class="org-left">Add underline</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a s</td>
<td class="org-left">Add strikeout</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a t</td>
<td class="org-left">Add text note</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a d</td>
<td class="org-left">Delete annotation</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a l</td>
<td class="org-left">List annotations</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a n/p</td>
<td class="org-left">Next/previous annotation</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Bookmarks</b></td>
<td class="org-left">b s</td>
<td class="org-left">Set bookmark</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">b j</td>
<td class="org-left">Jump to bookmark</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">b l</td>
<td class="org-left">List bookmarks</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Outline</b></td>
<td class="org-left">o</td>
<td class="org-left">Show outline/TOC</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">f</td>
<td class="org-left">Follow link</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">F</td>
<td class="org-left">Search links</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>Misc</b></td>
<td class="org-left">w</td>
<td class="org-left">Copy region as text</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">r</td>
<td class="org-left">Revert buffer</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-c C-p</td>
<td class="org-left">Print PDF</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-c i</td>
<td class="org-left">Extract images</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-c n</td>
<td class="org-left">Count pages</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-c C-c</td>
<td class="org-left">Display metadata</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orgdf859d0" class="outline-2">
<h2 id="orgdf859d0"><span class="section-number-2">5.</span> Utility Functions</h2>
<div class="outline-text-2" id="text-5">
<p>
General utility functions for improved Emacs workflow.
</p>
</div>

<div id="outline-container-org1872d6c" class="outline-3">
<h3 id="org1872d6c"><span class="section-number-3">5.1.</span> Open in External Application</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Open current file or URL in external application.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">misc-conf.el --- Miscellaneous Configuration  -*- lexical-binding: t; -*-
</span><span class="org-comment-delimiter">;;; </span><span class="org-comment">Commentary:
</span><span class="org-comment-delimiter">;;; </span><span class="org-comment">Code:
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Utility Functions
</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">fu/open-in-external-app</span> ()
  <span class="org-doc">"Open current file or URL in external application."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((path (<span class="org-keyword">or</span> (buffer-file-name)
                 (<span class="org-keyword">when</span> (eq major-mode 'dired-mode)
                   (dired-get-file-for-visit)))))
    (<span class="org-keyword">if</span> path
        (<span class="org-keyword">cond</span>
         ((eq system-type 'darwin)
          (call-process <span class="org-string">"open"</span> nil 0 nil path))
         ((eq system-type 'gnu/linux)
          (call-process <span class="org-string">"xdg-open"</span> nil 0 nil path))
         ((eq system-type 'windows-nt)
          (w32-shell-execute <span class="org-string">"open"</span> path)))
      (message <span class="org-string">"No file or URL to open"</span>))))

(global-set-key (kbd <span class="org-string">"C-c o"</span>) #'fu/open-in-external-app)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9d762c" class="outline-3">
<h3 id="orgc9d762c"><span class="section-number-3">5.2.</span> Copy File Path</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Copy current file path to clipboard.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">fu/copy-file-path</span> ()
  <span class="org-doc">"Copy the current buffer file path to clipboard."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when-let*</span> ((path (<span class="org-keyword">or</span> (buffer-file-name)
                       default-directory)))
    (kill-new path)
    (message <span class="org-string">"Copied: %s"</span> path)))

(global-set-key (kbd <span class="org-string">"C-c y p"</span>) #'fu/copy-file-path)
</pre>
</div>
</div>
</div>

<div id="outline-container-org5aed1f5" class="outline-3">
<h3 id="org5aed1f5"><span class="section-number-3">5.3.</span> Reload Configuration</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Quickly reload Emacs configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">fu/reload-config</span> ()
  <span class="org-doc">"Reload Emacs configuration."</span>
  (<span class="org-keyword">interactive</span>)
  (load-file user-init-file)
  (message <span class="org-string">"Configuration reloaded!"</span>))

(global-set-key (kbd <span class="org-string">"C-c r c"</span>) #'fu/reload-config)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ed24a4" class="outline-3">
<h3 id="org3ed24a4"><span class="section-number-3">5.4.</span> Kill Other Buffers</h3>
<div class="outline-text-3" id="text-5-4">
<p>
Kill all buffers except the current one.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">fu/kill-other-buffers</span> ()
  <span class="org-doc">"Kill all buffers except the current one."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((current-buf (current-buffer)))
    (<span class="org-keyword">dolist</span> (buf (buffer-list))
      (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (eq buf current-buf)
                 (string-prefix-p <span class="org-string">" "</span> (buffer-name buf)))
        (kill-buffer buf))))
  (message <span class="org-string">"Killed all other buffers"</span>))

(global-set-key (kbd <span class="org-string">"C-c k o"</span>) #'fu/kill-other-buffers)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org81ed633" class="outline-2">
<h2 id="org81ed633"><span class="section-number-2">6.</span> Database Configuration (Disabled)</h2>
<div class="outline-text-2" id="text-6">
<p>
Example database configuration with ejc-sql. Disabled by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Database Configuration - ejc-sql
</span>(<span class="org-keyword">use-package</span> ejc-sql
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:defer</span> t
  <span class="org-builtin">:custom</span>
  (clomacs-httpd-default-port 8888)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">let</span> ((ojdbc-path <span class="org-string">"~/.m2/repository/com/oracle/ojdbc8/8/ojdbc8-8.jar"</span>)
        (maria-path <span class="org-string">"~/.m2/repository/org/mariadb/jdbc/mariadb-java-client/2.6.2/mariadb-java-client-2.6.2.jar"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Oracle connection example
</span>    (ejc-create-connection
     <span class="org-string">"Oracle DB"</span>
     <span class="org-builtin">:classpath</span>      ojdbc-path
     <span class="org-builtin">:connection-uri</span> (concat <span class="org-string">"jdbc:oracle:thin:@"</span>
                            (getenv <span class="org-string">"DB_HOST"</span>) <span class="org-string">":"</span>
                            (getenv <span class="org-string">"DB_PORT"</span>) <span class="org-string">":"</span>
                            (getenv <span class="org-string">"DB_NAME"</span>))
     <span class="org-builtin">:user</span>           (getenv <span class="org-string">"DB_USERNAME"</span>)
     <span class="org-builtin">:password</span>       (getenv <span class="org-string">"DB_PASSWORD"</span>)
     <span class="org-builtin">:separator</span>      <span class="org-string">"/"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">MariaDB connection example
</span>    (ejc-create-connection
     <span class="org-string">"MariaDB"</span>
     <span class="org-builtin">:classpath</span>      maria-path
     <span class="org-builtin">:connection-uri</span> <span class="org-string">"jdbc:mariadb://host:port/dbname"</span>
     <span class="org-builtin">:user</span>           <span class="org-string">"username"</span>
     <span class="org-builtin">:password</span>       <span class="org-string">"password"</span>
     <span class="org-builtin">:separator</span>      <span class="org-string">"/"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd38c2a0" class="outline-2">
<h2 id="orgd38c2a0"><span class="section-number-2">7.</span> Scratch Buffers</h2>
<div class="outline-text-2" id="text-7">
<p>
Create temporary scratch buffers with specific major modes for quick testing and experimentation.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">create-scratch-with-mode</span> (mode)
  <span class="org-doc">"Create a new scratch buffer in the specified MODE.
Prompts for a major mode interactively and creates a uniquely
named scratch buffer in that mode."</span>
  (<span class="org-keyword">interactive</span>
   (list
    (intern
     (completing-read
      <span class="org-string">"Major mode for scratch buffer: "</span>
      (<span class="org-keyword">let</span> ((modes nil))
        (mapatoms
         (<span class="org-keyword">lambda</span> (symbol)
           (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (functionp symbol)
                      (string-match-p <span class="org-string">"-mode$"</span> (symbol-name symbol))
                      (not (string-match-p <span class="org-string">"-minor-mode$"</span> (symbol-name symbol))))
             (<span class="org-keyword">push</span> (symbol-name symbol) modes))))
        modes)
      nil nil nil nil <span class="org-string">"fundamental-mode"</span>))))
  (<span class="org-keyword">let*</span> ((mode-name (replace-regexp-in-string <span class="org-string">"-mode$"</span> <span class="org-string">""</span> (symbol-name mode)))
         (buffer-name (generate-new-buffer-name (format <span class="org-string">"*scratch-%s*"</span> mode-name)))
         (buf (get-buffer-create buffer-name)))
    (<span class="org-keyword">with-current-buffer</span> buf
      (funcall mode)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use mode's comment character or default to nothing if no comments
</span>      (<span class="org-keyword">when</span> comment-start
        (<span class="org-keyword">let</span> ((comment (string-trim comment-start)))
          (insert (format <span class="org-string">"%s Scratch buffer in %s\n%s Evaluate expressions and experiment freely!\n\n"</span>
                          comment (symbol-name mode)
                          comment)))))
    (switch-to-buffer buf)
    (message <span class="org-string">"Created scratch buffer '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' in %s"</span> buffer-name (symbol-name mode))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Quick shortcut for common modes
</span>(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-elisp</span> ()
  <span class="org-doc">"Create a scratch buffer in `</span><span class="org-doc"><span class="org-constant">emacs-lisp-mode</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">interactive</span>)
  (create-scratch-with-mode 'emacs-lisp-mode))

(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-org</span> ()
  <span class="org-doc">"Create a scratch buffer in `</span><span class="org-doc"><span class="org-constant">org-mode</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">interactive</span>)
  (create-scratch-with-mode 'org-mode))

(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-text</span> ()
  <span class="org-doc">"Create a scratch buffer in `</span><span class="org-doc"><span class="org-constant">text-mode</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">interactive</span>)
  (create-scratch-with-mode 'text-mode))

(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-python</span> ()
  <span class="org-doc">"Create a scratch buffer in `</span><span class="org-doc"><span class="org-constant">python-mode</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">interactive</span>)
  (create-scratch-with-mode 'python-mode))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Bind to a convenient key if desired:
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c s") 'create-scratch-with-mode)
</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd071ef6" class="outline-2">
<h2 id="orgd071ef6"><span class="section-number-2">8.</span> End of File</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">provide</span> '<span class="org-constant">misc-conf</span>)
<span class="org-comment-delimiter">;;; </span><span class="org-comment">misc-conf.el ends here</span>
</pre>
</div>
</div>
</div>
</main>
</body>
</html>
